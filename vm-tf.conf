#/bin/bash
# before running the script, please change identity to be root and set password of user ubuntu.

sudo apt-get update -y
sudo apt-get upgrade -y
sudo apt install zsh -y
sudo apt install python3.9 -y
sudo apt install python3-pip -y

chsh -s $(which zsh)
sh -c "$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"

# install anaconda
wget https://repo.anaconda.com/archive/Anaconda3-2021.11-Linux-x86_64.sh
chmod 755 Anaconda3-2021.11-Linux-x86_64.sh
./Anaconda3-2021.11-Linux-x86_64.sh
source ~/.zshrc

# install tensorflow==2.5.0 with conda
conda create -n tf tensorflow==2.5.0
echo "# Automate init for tf" >> ~/.zshrc
echo "conda activate tf" >> ~/.zshrc
source ~/.zshrc
pip install --upgrade tensorflow-hub

# clone api repo
git clone https://github.com/quminzhi/DevAPI.git

# interupt manually and install packages left
pip install Django==3.2.9
pip install djangorestframework-simplejwt
pip install djangorestframework
pip install django-filter
pip install django-cors-headers
pip install django-storages
pip install whitenoise
pip install opencv-python
sudo apt-get install ffmpeg libsm6 libxext6 -y
pip install pillow
sudo apt-get install libpq-dev
pip install psycopg2

# django
python manage.py makemigrations
python manage.py migrate
python manage.py runserver
